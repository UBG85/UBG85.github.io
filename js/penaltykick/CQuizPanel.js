function CQuizPanel(e){var t,n,i,a,r,s,h,l,c,o,d,_,f,w,g,u,T,A,p,C,v,S;this._init=function(){l=new Array,c=new Array,(C=new createjs.Container).visible=!1,e.addChild(C),(_=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),_.alpha=0,d=_.on("click",(function(){})),C.addChild(_),(v=new createjs.Container).x=CANVAS_WIDTH/2,C.addChild(v);var t=s_oSpriteLibrary.getSprite("msg_box_narrow"),n=createBitmap(t);n.regX=t.width/2,n.regY=t.height/2,v.addChild(n),A=new createjs.Container,v.addChild(A),p=new createjs.Container,v.addChild(p);var i=t.width-100,r=100,s=new createjs.Rectangle(-i/2,-60-r/2,i,r);f=new CTLText(v,s.x,s.y,s.width,s.height,50,"center","#ffffff",PRIMARY_FONT,1.1,0,0," ",!0,!0,!1,!1);i=170,r=60,s=new createjs.Rectangle(-i-80,10-r/2,i,r);w=new CTLText(A,s.x,s.y,s.width,s.height,50,"right","#ffffff",PRIMARY_FONT,1,0,0," ",!0,!0,!1,!1),o=new Array;for(var h=s_oSpriteLibrary.getSprite("but_generic"),S=0;S<4;S++)o[S]=new CTextButton(S*(250/3)-35,10,h," ",PRIMARY_FONT,"#FFFFFF",30,A),o[S].addEventListenerWithParams(ON_MOUSE_UP,this._onAnswer,this,S);T=new CRadialWipeWidget(90,10,v);var b=new createjs.Container;b.x=0,b.y=70,A.addChild(b),a=t.width-98;var E=20,O=new createjs.Shape;O.graphics.beginFill("#284361").drawRoundRect(-a/2,-10,a,E,10),b.addChild(O);var F=new createjs.Shape;F.graphics.beginFill("#3497eb").drawRoundRect(-a/2,-10,a,E,10),b.addChild(F),(g=new createjs.Shape).graphics.beginFill("#ffff00").drawRect(-a/2,-10,a,E),g.alpha=.01,b.addChild(g),F.mask=g,(u=new createjs.Shape).graphics.beginFill("#000000").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),u.alpha=.3,u.visible=!1,d=u.on("click",(function(){})),C.addChild(u)},this.unload=function(){_.off("click",d)},this.addEventListener=function(e,t,n){l[e]=t,c[e]=n},this.show=function(e,n,i,a,h){_.alpha=.01,v.y=CANVAS_HEIGHT/2,C.visible=!0,C.alpha=1,A.visible=!1,t=!1,u.visible=!1,this.changeMessage(TEXT_GET_A_BONUS_SHOT,"#FFF"),r=QUIZ_SHOW_COUNTDOWN,s=r,T.setVisible(!1),createjs.Tween.get(C).wait(QUIZ_SHOW_COUNTDOWN).call((function(){T.setVisible(!1),S._showAnswer(e,n,i,a,h)})).addEventListener("change",S._countDown)},this._showAnswer=function(e,t,n,a,l){A.visible=!0;var c=e[0]+" "+t+" "+e[1]+" =";w.refreshText(c),h=parseInt(n);for(var d=0;d<4;d++)o[d].changeText(a[d]),o[d].reset(),o[d].enable();s=r=l,i=setInterval((function(){S.update()}),FPS_TIME)},this.setSpectatorMode=function(){t=!0;TEXT_CPU;s_bMultiplayer&&s_oNetworkManager.getEnemyNickname().toUpperCase(),this.changeMessage(TEXT_OPPONENT_BONUS_QUESTION,"#FFF"),u.visible=!0},this.setAnswer=function(e){clearInterval(i),-1===e?(s=0,g.x=-a,this._turnOnTheRightAnswer(h),p.removeAllChildren(),s_oGame.setQuizTimeoutPanel()):this._onFinishAnimation(e)},this._onFinishAnimation=function(e){var t=!0;S._turnOnTheRightAnswer(h),p.removeAllChildren(),parseInt(o[e].getText())!==h&&(o[e].turnOff(),t=!1),s_oGame.onQuizEnd(t)},this._turnOnTheRightAnswer=function(e){for(var t=new Array,n=0;n<o.length;n++)t[n]=parseInt(o[n].getText()),t[n]===e&&o[n].turnOn()},this.hide=function(){createjs.Tween.get(C).to({alpha:0},500,createjs.Ease.quartOut).call((function(){C.visible=!1,v.y=CANVAS_HEIGHT_HALF}))},this.changeMessage=function(e,t){f.refreshText(e),t&&f.setColor(t)},this.setExplMessage=function(e){w.refreshText(e)},this._onAnswer=function(e){clearInterval(i);for(var t=0;t<o.length;t++)o[t].disable();n=ON_ANSWER,l[n]&&l[n].call(c[n],e)},this._onEndTimer=function(){s=0,g.x=-a,clearInterval(i);for(var e=0;e<o.length;e++)o[e].disable();t||(n=ON_QUIZ_TIMEOUT,l[n]&&l[n].call(c[n]))},this._countDown=function(){(s-=s_iTimeElaps)<0&&(s=0),T.update(s,r)},this.animDown=function(){var e=s_oSpriteLibrary.getSprite("msg_box_narrow"),t=CANVAS_HEIGHT_HALF+e.height/2;createjs.Tween.get(v).to({y:t},500,createjs.Ease.quartOut)},this.update=function(){s-=s_iTimeElaps,g.x=linearFunction(s,0,r,-a,0),s<0&&this._onEndTimer()},S=this,this._init()}